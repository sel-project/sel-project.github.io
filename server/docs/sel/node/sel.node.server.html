<html><head>
        <!-- Generated by Ddoc from sel/node/server.d -->
        <META http-equiv="content-type" content="text/html; charset=utf-8">
        <title>sel.node.server</title>
        </head><body>
        <h1>sel.node.server</h1>
<br><br>
<dl><dt><big><a name="server"></a>nothrow @nogc @property @safe Server <u>server</u>();
</big></dt>
<dd>Gets the <u>server</u> instance (plugins should use this
 function to get the <u>server</u>'s instance).<br><br>

</dd>
<dt><big><a name="Server"></a>class <u>Server</u>: <u>sel.event.event.EventListener!(ServerEvent).EventListener</u>, <u>sel.lang.Messageable</u>;
</big></dt>
<dd>Singleton for the server instance.<br><br>

<dl><dt><big><a name="Server.shutdown"></a>void <u>shutdown</u>();
</big></dt>
<dd>Stops the server setting the running variable to <b>false</b> and kicks every
 player from the server.<br><br>

</dd>
<dt><big><a name="Server.id"></a>pure nothrow @nogc @property @safe immutable(long) <u>id</u>();
</big></dt>
<dd>Gets the server's <u>id</u>, which is equal in the hub and all
 connected nodes.
 It is generated by SEL's snooping system or randomly if
 the service cannot be reached.<br><br>

</dd>
<dt><big><a name="Server.args"></a>pure nothrow @nogc @property @safe const(string[]) <u>args</u>();
</big></dt>
<dd>Gets the arguments the server has been launched with, excluding
 the ones used by sel or the manager.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=green>// from command-line
</font>./node --name=test -a -b -p=test
<font color=blue>assert</font>(server.<u>args</u> == [<font color=red>"-a"</font>, <font color=red>"-b"</font>]);

<font color=green>// from sel manager
</font>sel start test --name=test -a --loop -b
<font color=blue>assert</font>(server.<u>args</u> == [<font color=red>"-a"</font>, <font color=red>"-b"</font>]);
</pre>
 Custom arguments can be used by plugins to load optional settings.
<br><br>
<b>Example:</b><br>
<pre class="d_code">@start load() {
   <font color=blue>if</font>(!server.<u>args</u>.canFind(<font color=red>"--disable-example"</font>)) {
      <font color=blue>this</font>.loadImpl();
   }
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.settings"></a>pure nothrow @nogc @property @safe const(Config) <u>settings</u>();
</big></dt>
<dd>Gets the server's <u>settings</u>.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=green>// server name
</font>log(<font color=red>"Welcome to "</font>, server.<u>settings</u>.name);

<font color=green>// game version
</font><font color=blue>static</font> <font color=blue>if</font>(__pocket) <font color=blue>assert</font>(server.<u>settings</u>.pocket);
<font color=blue>static</font> <font color=blue>if</font>(__minecraft) log(<font color=red>"Port for Minecraft: "</font>, server.<u>settings</u>.minecraft.port);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.name"></a>pure nothrow @nogc @property @safe string <u>name</u>();
</big></dt>
<dd>Gets the server's <u>name</u>, as indicated in the hub's
 settings.txt file.
 The <u>name</u> should just the <u>name</u> of the server without
 any formatting code nor description.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=red>"Potato Empire"</font> <font color=green>// do
</font><font color=red>"potato empire"</font> <font color=green>// don't
</font><font color=red>"Potato Empire: NEW MINIGAMES!"</font> <font color=green>// don't
</font><font color=red>"§aPotato §5Empire"</font> <font color=green>// don't
</font></pre>
<br><br>

</dd>
<dt><big><a name="Server.online"></a>pure nothrow @nogc @property @safe size_t <u>online</u>();
</big></dt>
<dd>Gets the number of <u>online</u> players in the current
 node (not in the whole server).<br><br>

</dd>
<dt><big><a name="Server.max"></a>pure nothrow @nogc @property @safe size_t <u>max</u>();
</big></dt>
<dd>Gets the maximum number of players that can connect on the
 current node (not in the whole server).
 If the value is 0 there's no limit.<br><br>

</dd>
<dt><big><a name="Server.hubOnline"></a>pure nothrow @nogc @property @safe size_t <u>hubOnline</u>();
</big></dt>
<dd>Gets the number of online players in the whole server
 (not just in the current node).<br><br>

</dd>
<dt><big><a name="Server.hubMax"></a>pure nothrow @nogc @property @safe size_t <u>hubMax</u>();
</big></dt>
<dd>Gets the number of maximum players that can connect to
 the hub.
 If the value is 0 it means that no limit has been set and
 players will never be kicked because the server is full.<br><br>

</dd>
<dt><big><a name="Server.nodeName"></a>pure nothrow @nogc @property @safe string <u>nodeName</u>();
</big></dt>
<dd>Gets the current's node name.<br><br>

</dd>
<dt><big><a name="Server.isMainNode"></a>pure nothrow @nogc @property @safe bool <u>isMainNode</u>();
</big></dt>
<dd>Gets whether or not this is a main node (players are added
 when connected to hub) or not (player are added only when
 transferred by other nodes).<br><br>

</dd>
<dt><big><a name="Server.social"></a>const pure nothrow @nogc @property @safe auto <u>social</u>();
</big></dt>
<dd>Gets the server's <u>social</u> informations like website and <u>social</u>
 networks names.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>if</font>(server.<u>social</u>.facebook.length) {
   world.broadcast(<font color=red>"Follow us on facebook! facebook.com/"</font> ~ server.<u>social</u>.facebook);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.website"></a>pure nothrow @nogc @property @safe string <u>website</u>();
</big></dt>
<dd>Gets the server's <u>website</u>.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>assert</font>(server.<u>website</u> == server.social.<u>website</u>);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.hubAddress"></a>pure nothrow @nogc @property @safe Address <u>hubAddress</u>();
</big></dt>
<dd>Gets the address of the hub this node is connected to.
<br><br>
<b>Returns:</b><br>
the address of the hub connected to, or <b>null</b> if not connected yet
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>if</font>(server.<u>hubAddress</u>.toAddrString() == <font color=red>"127.0.0.1"</font>) {
   log(<font color=red>"the hub is ipv4 localhost!"</font>);
} <font color=blue>else</font> <font color=blue>if</font>(server.<u>hubAddress</u>.toAddrString() == <font color=red>"::1"</font>) {
   log(<font color=red>"The hub is ipv6 localhost!"</font>);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.hubLatency"></a>pure nothrow @nogc @property @safe uint <u>hubLatency</u>();
</big></dt>
<dd>Gets the latency between the node and the hub.<br><br>

</dd>
<dt><big><a name="Server.ticks"></a>pure nothrow @nogc @property @safe tick_t <u>ticks</u>();
</big></dt>
<dd>Gets the number of <u>ticks</u> since the server has connected with hub.
 The number of <u>ticks</u> do not indicate the uptime of the server, because
 there's the probability that the server's resources can't handle 20
 <u>ticks</u> per second.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>if</font>(server.<u>ticks</u> / 20 != server.uptime.seconds) {
   d(<font color=red>"The server was lagging!"</font>);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.tps"></a>pure nothrow @nogc @property @safe float <u>tps</u>();
</big></dt>
<dd>Gets the average TPS (ticks per second).
<br><br>
<b>Returns:</b><br>
A floating point number between in range 0..20, where 20 is the best
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>if</font>(server.<u>tps</u> != 20) {
   d(<font color=red>"Server's is going at less than 20 TPS!"</font>);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.uptime"></a>@property @safe Duration <u>uptime</u>();
</big></dt>
<dd>Gets the server's <u>uptime</u> as a Duration instance with milliseconds precision.
 The count starts when the node is duccessfully connected with the hub.
<br><br>
<b>Example:</b><br>
<pre class="d_code">d(<font color=red>"The server is online from "</font>, server.<u>uptime</u>.minutes, <font color=red>" minutes"</font>);

<font color=blue>ulong</font> m, s;
server.<u>uptime</u>.split!(<font color=red>"minutes"</font>, <font color=red>"seconds"</font>)(m, s);
d(<font color=red>"The server is online from "</font>, m, <font color=red>" minutes and "</font>, s, <font color=red>" seconds"</font>);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.ram"></a>@nogc @property @safe Memory <u>ram</u>();
</big></dt>
<dd>Gets the current memory (RAM and SWAP) usage.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>if</font>(server.<u>ram</u>.gigabytes &gt;= mem!<font color=red>"GB"</font>(1)) {
   d(<font color=red>"The server is using more than 1 GB of RAM!"</font>);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.cpu"></a>pure nothrow @nogc @property @safe float <u>cpu</u>();
</big></dt>
<dd>Gets the current CPU usage.
<br><br>
<b>Example:</b><br>
<pre class="d_code">d(<font color=red>"The server is using "</font>, server.<u>cpu</u>, <font color=red>"% on "</font>, totalCPUs, <font color=red>" CPUs"</font>);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.nodes"></a>pure nothrow @property @trusted const(Node)[] <u>nodes</u>();
</big></dt>
<dd>Gets a list with the <u>nodes</u> connected to the hub, this excluded.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>foreach</font>(node ; server.<u>nodes</u>) {
   <font color=blue>assert</font>(node.name != server.nodeName);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.nodeWithName"></a>inout pure nothrow @safe const(Node) <u>nodeWithName</u>(string <i>name</i>);
</big></dt>
<dd>Gets a node by its <i>name</i>. It can be used to transfer players
 to it.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>auto</font> lobby = server.<u>nodeWithName</u>(<font color=red>"lobby"</font>);
<font color=blue>if</font>(lobby !<font color=blue>is</font> <font color=blue>null</font>) lobby.transfer(player);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.nodeWithHubId"></a>inout pure nothrow @safe const(Node) <u>nodeWithHubId</u>(uint <i>hubId</i>);
</big></dt>
<dd>Gets a node by its hub id, which is given by the hub and
 unique for every session.<br><br>

</dd>
<dt><big><a name="Server.sendMessage"></a>void <u>sendMessage</u>(Node[] <i>nodes</i>, ubyte[] <i>payload</i>);
<br>void <u>sendMessage</u>(Node <i>node</i>, ubyte[] <i>payload</i>);
</big></dt>
<dd>Sends a message to a <i>node</i>.<br><br>

</dd>
<dt><big><a name="Server.broadcast"></a>void <u>broadcast</u>(ubyte[] <i>payload</i>);
</big></dt>
<dd>Broadcasts a message to every node connected to the hub.<br><br>

</dd>
<dt><big><a name="Server.plugins"></a>pure nothrow @nogc @property @safe const(Plugin)[] <u>plugins</u>();
</big></dt>
<dd>Gets the <u>plugins</u> actived on the server.
<br><br>
<b>Example:</b><br>
<pre class="d_code">log(<font color=red>"There are "</font>, server.<u>plugins</u>.filter!(a =&gt; a.author == <font color=red>"sel-plugins"</font>).length, <font color=red>" by sel-plugins"</font>);
log(<font color=red>"There are "</font>, server.<u>plugins</u>.filter!(a =&gt; a.api).length, <font color=red>" plugins with APIs"</font>);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.world"></a>pure nothrow @nogc @property @safe World <u>world</u>();
</big></dt>
<dd>Gets the server's default <u>world</u>.<br><br>

</dd>
<dt><big><a name="Server.world.2"></a>pure nothrow @nogc @property @safe World <u>world</u>(World <u>world</u>);
</big></dt>
<dd>Sets the server's default <u>world</u> if the given <u>world</u> has been
 created and registered using the addWorld template method.
<br><br>
<b>Returns:</b><br>
The server's default <u>world</u> (the given <u>world</u> if it has been set as default)
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>auto</font> test = server.addWorld!Test(<font color=red>"test-world"</font>);
server.<u>world</u> = test;
<font color=blue>assert</font>(server.<u>world</u> == test);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.worlds"></a>pure nothrow @property @safe World[] <u>worlds</u>();
</big></dt>
<dd>Gets a list with every world registered in the server.
 The list is a copy of the one kept by the server and its
 modification has no effect on the server.<br><br>

</dd>
<dt><big><a name="Server.worldsWithName"></a>pure nothrow @safe World[] <u>worldsWithName</u>(string <i>name</i>);
</big></dt>
<dd>Gets a list of worlds with the same <i>name</i> (case sensitive).
 This method should only be used by commands as saving the
 world instance is faster and safer.
<br><br>
<b>Example:</b><br>
<pre class="d_code">log(<font color=red>"There are "</font>, server.<u>worldsWithName</u>(<font color=red>"overworld"</font>).length, <font color=red>" named overworld"</font>);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.worldsWithNameIns"></a>World[] <u>worldsWithNameIns</u>(string <i>name</i>);
</big></dt>
<dd>Gets a list of worlds with the same <i>name</i> (case insnsitive).
<br><br>
<b>Example:</b><br>
<pre class="d_code">server.addWorld(<font color=red>"Uppercase"</font>);
<font color=blue>assert</font>(server.worldsWithName(<font color=red>"uppercase"</font>).length + 1 == server.<u>worldsWithNameIns</u>(<font color=red>"uppercase"</font>));
</pre>
<br><br>

</dd>
<dt><big><a name="Server.worldWithId"></a>pure nothrow @nogc @safe World <u>worldWithId</u>(uint <i>id</i>);
</big></dt>
<dd>Gets a world by its <i>id</i>.
<br><br>
<b>Returns:</b><br>
The World instance or <b>null</b> if the world is not registered.<br><br>

</dd>
<dt><big><a name="Server.addWorld"></a>T <u>addWorld</u>(T : World = World, E...)(E <i>args</i>);
</big></dt>
<dd>Creates and registers a world, initialising its terrain,
 registering events, commands and tasks.
<br><br>
<b>Example:</b><br>
<pre class="d_code">server.<u>addWorld</u>(<font color=red>"world42"</font>); <font color=green>// normal world
</font>server.<u>addWorld</u>!CustomWorld(42); <font color=green>// custom world where 42 is passed to the constructor
</font></pre>
<br><br>

</dd>
<dt><big><a name="Server.removeWorld"></a>bool <u>removeWorld</u>(World <i>world</i>);
</big></dt>
<dd>Removes a <i>world</i> and unloads it.
 When trying to remove the default <i>world</i> a message error will be
 displayed and the <i>world</i> will not be unloaded.<br><br>

</dd>
<dt><big><a name="Server.players"></a>pure nothrow @property @trusted Player[] <u>players</u>();
</big></dt>
<dd>Gets a list with all the <u>players</u> in the server.<br><br>

</dd>
<dt><big><a name="Server.playersWithName"></a>pure @trusted Player[] <u>playersWithName</u>(string <i>name</i>);
</big></dt>
<dd>Gets a player by a case-insensitive <i>name</i>.
<br><br>
<b>Returns:</b><br>
An array of online players with the given <i>name</i>.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>foreach</font>(player ; server.<u>playersWithName</u>(<font color=red>"steve"</font>)) {
  player.kick(<font color=red>"Bad name!"</font>);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.playerWithHubId"></a>pure nothrow @nogc @safe Player <u>playerWithHubId</u>(uint <i>hubId</i>);
</big></dt>
<dd>Gets a player by its hub id.
<br><br>
<b>Returns:</b><br>
The player instance or <b>null</b> if there is not player with the given hub id<br><br>

</dd>
<dt><big><a name="Server.broadcast.2"></a>void <u>broadcast</u>(E...)(E <i>args</i>);
</big></dt>
<dd>Broadcasts a message in every registered world and their children
 calling the world's <u>broadcast</u> method.<br><br>

</dd>
<dt><big><a name="Server.registerCommand"></a>void <u>registerCommand</u>(alias func)(void delegate(Parameters!func) <i>del</i>, string <i>command</i>, string <i>description</i>, string[] <i>aliases</i>, string[] <i>params</i>, bool <i>op</i>, bool <i>hidden</i>);
</big></dt>
<dd>Registers a <i>command</i>.<br><br>

</dd>
<dt><big><a name="Server.disconnect"></a>void <u>disconnect</u>(Player <i>player</i>, string <i>reason</i>);
<br>void <u>disconnect</u>(Player <i>player</i>, string <i>reason</i>, string[] <i>args</i>);
</big></dt>
<dd>Disconnects a <i>player</i> from the server.
 When using a translatable message <i>player</i>'s should be disconnected
 using their own <u>disconnect</u> method (Player.<u>disconnect</u>);
<br><br>
<b>Example:</b><br>
<pre class="d_code">@event jump(PlayerJumpEvent e) {
  server.<u>disconnect</u>(e.<i>player</i>, <font color=red>"You can't jump on this server"</font>);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.transfer"></a>void <u>transfer</u>(Player <i>player</i>, inout Node <i>node</i>);
</big></dt>
<dd>Transfers a <i>player</i> to another <i>node</i>.
<br><br>
<b>Params:</b><br>
<table><tr><td>Player <i>player</i></td>
<td>the <i>player</i> to <u>transfer</u></td></tr>
<tr><td>Node <i>node</i></td>
<td>name of the <i>node</i> where the <i>player</i> will be transferred</td></tr>
</table><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>if</font>(server.nodes.length) {
   server.<u>transfer</u>(<i>player</i>, server.nodes[0]);
}
</pre>
<br><br>

</dd>
<dt><big><a name="Server.addTask"></a>@safe size_t <u>addTask</u>(E...)(void delegate(E) <i>task</i>, size_t <i>interval</i>, size_t <i>repeat</i> = size_t.max) if (areValidTaskArgs!E);
<br><a name="Server.schedule"></a>alias <u>schedule</u> = addTask(E...)(void delegate(E) task, size_t interval, size_t repeat = size_t.max) if (areValidTaskArgs!E);
</big></dt>
<dd>Registers a <i>task</i>.
<br><br>
<b>Params:</b><br>
<table><tr><td>void delegate(E) <i>task</i></td>
<td>a function or a delegate that will be called every <i>interval</i></td></tr>
<tr><td>size_t <i>interval</i></td>
<td>number of ticks indicating the repeating <i>interval</i></td></tr>
<tr><td>size_t <i>repeat</i></td>
<td>number of times to <i>repeat</i> the <i>task</i></td></tr>
</table><br>
<b>Returns:</b><br>
the new <i>task</i> id that can be used to remove the <i>task</i><br><br>

</dd>
<dt><big><a name="Server.delay"></a>@safe size_t <u>delay</u>(E...)(void delegate(E) <i>task</i>, size_t <i>timeout</i>) if (areValidTaskArgs!E);
</big></dt>
<dd>Executes a <i>task</i> one time after the given ticks.
<br><br>
<b>Example:</b><br>
<pre class="d_code"><font color=blue>immutable</font> expected = server.ticks + 100;
server.<u>delay</u>({
   <font color=blue>assert</font>(server.ticks = expected);
}, 100);
</pre>
<br><br>

</dd>
<dt><big><a name="Server.removeTask"></a>@safe void <u>removeTask</u>(E...)(void delegate(E) <i>task</i>) if (areValidTaskArgs!E);
<br>@safe void <u>removeTask</u>(size_t <i>tid</i>);
</big></dt>
<dd>Removes a <i>task</i> using the <i>task</i>'s delegate or the id returned
 by the addTask function.<br><br>

</dd>
</dl>
</dd>
</dl>

        <hr><small>Page generated by <a href="http://dlang.org/ddoc.html">Ddoc</a>. </small>
        </body></html>
